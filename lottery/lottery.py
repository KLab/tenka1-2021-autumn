N = 21399100043898499081888303521929750407714306922144046892991516326128416385402891943164368739400126595675227055319260099749830330860578373484366866285199766249274929742505077096106785706357670903551288812472640989947218430453318452867069771366516301599618825925820449724264230583661975545724619035219806444290496779623155457057980127745198075170702207633425467728416796896786799380281512902475724189539497313892092720150806621071332960127278434423801427869042641325114298721308252212423198507375916983590991925994159140397964710926702693535701283187382174438919514520482165046078305829653669614291875283364480174925237


def main():
    # key.txtは当選者決定後に公開します
    with open('key.txt') as f:
        a = f.readlines()
        p = int(a[0])
        q = int(a[1])
        d = int(a[2])
    assert p * q == N
    assert d * 65537 % ((p - 1) * (q - 1)) == 1
    m = pow(1 << 1000, d, N)

    # users.txtは抽選対象者のIDを改行区切りで入れたもの
    with open('users.txt', 'rb') as f:
        users = sorted(x for x in f.read().split(b'\n') if x != b'')

    h = 5381
    for s in users:
        for c in s:
            h = (h * 33 + c) % (1 << 64)

    x = (m + h) % (1 << 64)
    for _ in range(20):
        x = (x * 6364136223846793005 + 1) % (1 << 64)
        y = (x >> 32) % len(users)
        print(users[y].decode())
        del users[y]


main()
